<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ê°ì ë†ì¥</title>
</head>
<body>
  <h1>ğŸ³ ê°ì ë†ì¥ì— ì˜¤ì‹  ê±¸ í™˜ì˜í•©ë‹ˆë‹¤!</h1>
  <p>ì„œë²„ ì •ìƒ ì‘ë™ ì¤‘ì…ë‹ˆë‹¤.</p>
  <script>
    const nickname = localStorage.getItem("nickname") || "ë²”ê³ ë˜X";
    localStorage.setItem("nickname", nickname);

    // ê³µí†µ ì‘ë‹µ ì²´í¬ í•¨ìˆ˜
    function handleResponse(res) {
      if (!res.ok) {
        throw new Error(`ì‘ë‹µ ì‹¤íŒ¨ (${res.status}): ${res.statusText}`);
      }
      const contentType = res.headers.get("content-type") || "";
      if (!contentType.includes("application/json")) {
        throw new Error("ì„œë²„ê°€ JSON ëŒ€ì‹  HTML ë“±ì„ ë¦¬í„´í•¨. content-type: " + contentType);
      }
      return res.json();
    }

    fetch("api/ping")
      .then(handleResponse)
      .then(data => {
        const div = document.createElement("div");
        div.textContent = "âœ… ì„œë²„ ì‘ë‹µ: " + data.message;
        document.body.appendChild(div);

        return fetch("api/gamja?nickname=" + nickname);
      })
      .then(handleResponse)
      .then(data => {
        const info = document.createElement("pre");
        info.textContent = JSON.stringify(data, null, 2);
        document.body.appendChild(info);
      })
      .catch(err => {
        const errBox = document.createElement("div");
        errBox.style.color = "red";
        errBox.textContent = "âŒ ì„œë²„ ë¬¸ì œ: " + err.message;
        document.body.appendChild(errBox);
      });
  </script>
</body>
</html>
