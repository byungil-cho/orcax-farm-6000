<!-- /public/factory.html -->
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OrcaX Factory</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-yellow-50 to-orange-100 min-h-screen flex items-center justify-center px-4 py-6">
  <div class="w-full max-w-md bg-white rounded-2xl shadow-xl p-6 space-y-6">
    <div class="text-center">
      <h1 class="text-3xl font-bold text-yellow-600 mb-1">ğŸ­ ê°€ê³µê³µì¥</h1>
      <p class="text-sm text-gray-500">ê°ìì™€ ë³´ë¦¬ë¥¼ ê°€ê³µí•´ì„œ ì œí’ˆì„ ë§Œë“œì„¸ìš”!</p>
    </div>
    <div class="space-y-4">
      <button onclick="processItem('potato')" class="w-full bg-orange-400 text-white py-3 rounded-xl hover:bg-orange-500 transition font-semibold text-lg">
        ğŸ¥” ê°ì â†’ ê°ìì¹©
      </button>
      <button onclick="processItem('barley')" class="w-full bg-amber-500 text-white py-3 rounded-xl hover:bg-amber-600 transition font-semibold text-lg">
        ğŸŒ¾ ë³´ë¦¬ â†’ ë³´ë¦¬ì°¨
      </button>
    </div>
    <div class="text-gray-700 text-sm bg-gray-50 p-4 rounded-xl mt-4">
      <p id="fuel-status" class="mb-1">ì—°ë£Œ: ë¡œë”©ì¤‘...</p>
      <p id="inventory-status">ì¸ë²¤í† ë¦¬: ë¡œë”©ì¤‘...</p>
    </div>
    <div class="text-center text-xs text-gray-400 mt-6">
      â›½ ì—°ë£Œ 1ê°œë¥¼ ì†Œë¹„í•´ 10ì´ˆ í›„ ê°€ê³µë©ë‹ˆë‹¤.
    </div>
  </div>

  <script>
    const USER_ID = 'USER123';

    async function processItem(type) {
      const res = await fetch(`/factory/queue`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ user_id: USER_ID, item_type: type })
      });
      const data = await res.json();
      alert(data.message || 'ê°€ê³µ ëŒ€ê¸°ì—´ ë“±ë¡ ì™„ë£Œ');
      updateStatus();
    }

    async function updateStatus() {
      const res = await fetch(`/user/${USER_ID}`);
      const data = await res.json();
      const inv = data.inventory || {};
      document.getElementById("fuel-status").innerText = `ì—°ë£Œ: ${inv.fuel || 0}`;
      document.getElementById("inventory-status").innerText =
        `ê°ì: ${inv.potato || 0}, ê°ìì¹©: ${inv.chips || 0}, ë³´ë¦¬: ${inv.barley || 0}, ë³´ë¦¬ì°¨: ${inv.barley_tea || 0}`;
    }

    updateStatus();
  </script>
</body>
</html>
