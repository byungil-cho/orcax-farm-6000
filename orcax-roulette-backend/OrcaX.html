<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OrcaX ê´€ë¦¬ì ëª¨ë“œ</title>
  <style>
    body {
      background-color: #111;
      color: #00e0c7;
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 2rem;
    }
    h1 {
      color: #00ffc3;
      margin-bottom: 2rem;
    }
    #floating-notice {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: #222;
      color: #ffeb3b;
      padding: 0.7rem 0;
      font-size: 1rem;
      font-weight: bold;
      z-index: 9999;
      overflow: hidden;
      white-space: nowrap;
    }
    #notice-marquee {
      display: inline-block;
      padding-left: 100%;
      animation: scroll-left 20s linear infinite;
    }
    @keyframes scroll-left {
      0% { transform: translateX(0); }
      100% { transform: translateX(-100%); }
    }
    button {
      display: block;
      width: 80%;
      max-width: 400px;
      margin: 1rem auto;
      padding: 1rem;
      background: linear-gradient(135deg, #00ffc3, #00b2ff);
      color: #111;
      font-size: 1.1rem;
      font-weight: bold;
      border: none;
      border-radius: 1rem;
      cursor: pointer;
      transition: transform 0.2s ease;
    }
    button:hover {
      transform: scale(1.05);
    }
    .price-board, .summary-board, .roulette-board, .server-board, .admin-tools, .notice-board {
      margin-top: 3rem;
      background: #222;
      padding: 1.5rem;
      border-radius: 1rem;
      width: 90%;
      max-width: 500px;
      margin-left: auto;
      margin-right: auto;
      text-align: center;
      color: #00ffc3;
      font-size: 1.1rem;
    }
    .fixed-price {
      font-size: 1.2rem;
      margin-bottom: 1rem;
      color: #ffec8b;
    }
    textarea {
      width: 100%;
      height: 100px;
      padding: 0.8rem;
      font-size: 1rem;
      border-radius: 0.5rem;
      border: none;
      resize: none;
      background-color: #111;
      color: #00ffc3;
    }
    #dashboard { display: none; }
    #login-box {
      background: #222;
      padding: 2rem;
      border-radius: 1rem;
      max-width: 400px;
      margin: 4rem auto;
    }
    input[type="password"] {
      padding: 0.8rem;
      font-size: 1rem;
      width: 80%;
      border-radius: 0.5rem;
      border: none;
      margin-bottom: 1rem;
    }
  </style>
</head>
<body>
  <div id="floating-notice" style="display:none;"><div id="notice-marquee"></div></div>
  <div id="login-box">
    <h1>ğŸ” ê´€ë¦¬ì ë¡œê·¸ì¸</h1>
    <input type="password" id="admin-pass" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥" />
    <button onclick="checkLogin()">ë¡œê·¸ì¸</button>
    <p id="login-msg" style="color: #f66; font-weight: bold;"></p>
  </div>
  <div id="dashboard">
    <h1>ğŸ“¡ OrcaX ê´€ë¦¬ì íŒ¨ë„</h1>
    <button onclick="window.open('http://localhost:3000/orders.html')">ğŸ›’ ì£¼ë¬¸ ëª©ë¡ ë³´ê¸°</button>
    <button onclick="window.open('http://localhost:3010/spins.json')">ğŸ° ë£°ë › ì ìˆ˜ ë³´ê¸°</button>
    <button onclick="window.open('http://localhost:3001/public/sms.html')">ğŸ’¬ ë¬¸ì ë°œì†¡ í˜ì´ì§€</button>
    <button onclick="window.open('http://localhost:3000/public/shop.html')">ğŸ§¾ ì¿ í° ìƒì  (Shop)</button>
    <button onclick="window.open('http://localhost:3000/public/puzzle.html')">ğŸ§  í¼ì¦ ê²Œì„</button>
    <div class="summary-board">
      <h2>ğŸ“Š ì´ ì£¼ë¬¸ íšŸìˆ˜</h2>
      <div id="order-total">ì£¼ë¬¸ ê³„ì • ì¤‘...</div>
    </div>
    <div class="roulette-board">
      <h2>ğŸ¯ ëˆ„ì  ë£°ë › ì ìˆ˜</h2>
      <div id="roulette-total">ê³„ì‚° ì¤‘...</div>
    </div>
    <div class="server-board">
      <h2>ğŸ›°ï¸ ì„œë²„ ìƒíƒœ</h2>
      <div id="status-backend">orcax-backend: í™•ì¸ ì¤‘...</div>
      <div id="status-sms">orcax-sms-backend: í™•ì¸ ì¤‘...</div>
      <div id="status-roulette">orcax-roulette-backend: í™•ì¸ ì¤‘...</div>
    </div>
    <div class="price-board">
      <div class="fixed-price">ğŸ§¨ OrcaX ê³ ì • ì‹œì„¸: 1 ORCX = 1ì›</div>
      <h2>ğŸ“ˆ ì‹¤ì‹œê°„ ì‹œì„¸</h2>
      <div>USD/KRW: <span id="usd-krw">...</span></div>
      <div>BTC: <span id="btc-krw">...</span></div>
      <div>ETH: <span id="eth-krw">...</span></div>
      <div>Pi Network: <span id="pi-usdt">...</span></div>
    </div>
    <div class="admin-tools">
      <h2>ğŸ§° ê´€ë¦¬ì ë„êµ¬</h2>
      <button onclick="alert('ê³§ ì¶”ê°€ë  ê¸°ëŠ¥ì…ë‹ˆë‹¤')">ğŸ“¤ ì¿ í° ìˆ˜ë™ ë°œê¸‰</button>
      <button onclick="alert('ê³§ ì¶”ê°€ë  ê¸°ëŠ¥ì…ë‹ˆë‹¤')">ğŸ“‚ ì£¼ë¬¸ ë°ì´í„° ë°±ì—…</button>
      <button onclick="alert('ê³§ ì¶”ê°€ë  ê¸°ëŠ¥ì…ë‹ˆë‹¤')">ğŸ–¼ ì´ë¯¸ì§€ ì—…ë¡œë“œ</button>
    </div>
    <div class="notice-board">
      <h2>ğŸ“¢ ê³µì§€ì‚¬í•­ ì…ë ¥</h2>
      <textarea id="notice-text" placeholder="ê³µì§€ì‚¬í•­ ë‚´ìš©ì„ ì‰¼í‘œë¡œ êµ¬ë¶„í•˜ì—¬ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
      <button onclick="saveNotice()">ê³µì§€ ë“±ë¡</button>
      <p id="notice-result"></p>
    </div>
  </div>
  <script>
    function checkLogin() {
      const pw = document.getElementById('admin-pass').value;
      const msg = document.getElementById('login-msg');
      if (pw === 'orcaxadmin') {
        document.getElementById('login-box').style.display = 'none';
        document.getElementById('dashboard').style.display = 'block';
        fetchPrices();
        fetchOrderCount();
        fetchRouletteTotal();
        checkServerStatus();
        setInterval(fetchPrices, 60000);
        setInterval(fetchOrderCount, 60000);
        setInterval(fetchRouletteTotal, 60000);
        setInterval(checkServerStatus, 60000);
      } else {
        msg.textContent = 'ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤';
      }
    }
    function fetchPrices() {
      fetch("https://api.exchangerate-api.com/v4/latest/USD")
        .then(res => res.json())
        .then(data => document.getElementById("usd-krw").textContent = data.rates.KRW.toLocaleString() + ' â‚©');
      fetch("https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum&vs_currencies=krw")
        .then(res => res.json())
        .then(data => {
          document.getElementById("btc-krw").textContent = data.bitcoin.krw.toLocaleString() + ' â‚©';
          document.getElementById("eth-krw").textContent = data.ethereum.krw.toLocaleString() + ' â‚©';
        });
      fetch("https://api.coinxhigh.com/public/v1/ticker?market=PI_USDT")
        .then(res => res.json())
        .then(data => document.getElementById("pi-usdt").textContent = data.ticker.last + ' USDT');
    }
    function fetchOrderCount() {
      fetch("http://localhost:3000/orders.json")
        .then(res => res.json())
        .then(data => document.getElementById("order-total").textContent = `${data.length.toLocaleString()} ê°œ`)
        .catch(() => document.getElementById("order-total").textContent = "ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜");
    }
    function fetchRouletteTotal() {
      fetch("http://localhost:3010/spins.json")
        .then(res => res.json())
        .then(data => {
          let total = 0;
          data.forEach(item => {
            const match = item.result.match(/(\d+)/);
            if (match) total += parseInt(match[1]);
          });
          document.getElementById("roulette-total").textContent = `${total.toLocaleString()} ORCX`;
        })
        .catch(() => document.getElementById("roulette-total").textContent = "ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜");
    }
    function checkServerStatus() {
      const servers = [
        { id: 'status-backend', url: 'http://localhost:3000' },
        { id: 'status-sms', url: 'http://localhost:3001' },
        { id: 'status-roulette', url: 'http://localhost:3010' }
      ];
      servers.forEach(server => {
        fetch(server.url)
          .then(() => document.getElementById(server.id).textContent = `${server.url} ğŸŸ¢ ì •ìƒ`)
          .catch(() => document.getElementById(server.id).textContent = `${server.url} ğŸ”´ ì¤‘ë‹¨ë¨`);
      });
    }
    let noticeIndex = 0;
    let noticeList = [];
    function rotateNotices() {
      if (noticeList.length > 0) {
        document.getElementById("notice-marquee").textContent = noticeList[noticeIndex];
        document.getElementById("floating-notice").style.display = "block";
        noticeIndex = (noticeIndex + 1) % noticeList.length;
      }
    }
    function saveNotice() {
      const text = document.getElementById("notice-text").value.trim();
      if (text.length === 0) {
        document.getElementById("notice-result").textContent = "âš ï¸ ê³µì§€ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”.";
        document.getElementById("floating-notice").style.display = "none";
        return;
      }
      noticeList = text.split(',').map(item => item.trim()).filter(Boolean);
      if (noticeList.length > 0) {
        document.getElementById("notice-result").textContent = "âœ… ê³µì§€ê°€ ìˆœì°¨ì ìœ¼ë¡œ ìƒë‹¨ì— í‘œì‹œë©ë‹ˆë‹¤.";
        rotateNotices();
        setInterval(rotateNotices, 10000);
      }
    }
  </script>
</body>
</html>
